#!/bin/bash

PWD=$(pwd)
USER=$(whoami)
BASE_HOME=${XDG_DATA_HOME:-$HOME/.local/share}
CARGO_HOME="${BASE_HOME}/cargo/registry"

mkdir -p "${CARGO_HOME}"
docker run -ti \
	--rm \
	--env "USER=${USER}" \
	--volume "${CARGO_HOME}:/usr/local/cargo/registry" \
	--volume "${PWD}:${PWD}" \
	--workdir "${PWD}" \
	--log-driver none \
	--entrypoint clippy-driver \
	rust:slim "${@}"
